Задача 1
#Вместо этой строки сюда писать запрос - ответ на задачу 1
select orderNumber,productCode, quantityOrdered * priceEach as all_price
from orderdetails
order by all_price desc
limit 10

Задача 2
#Вместо этой строки сюда писать запрос - ответ на задачу 2
select orderNumber, sum(quantityOrdered * priceEach) as total
from orderdetails
group by 1
having total > 59000
order by total desc

Задача 3
#Вместо этой строки сюда писать запрос - ответ на задачу 3
select t1.orderNumber, t2.orderDate, t2.status, 
sum(t1.quantityOrdered * t1.priceEach) as total
from orderdetails t1
join orders t2
on t1.orderNumber=t2.orderNumber
group by 1,2,3
having total > 59000
order by total desc

Задача 4
#Вместо этой строки сюда писать запрос - ответ на задачу 4
select t3.contactFirstName, t3.contactLastName, 
t3.country, t1.orderNumber, t2.orderDate, t2.status, 
sum(t1.quantityOrdered * t1.priceEach) as total
from orderdetails t1
join orders t2
on t1.orderNumber=t2.orderNumber
join customers t3
on t3.customerNumber=t2.customerNumber
group by 1,2,3,4,5
having total > 59000
order by total desc

Задача 5
#Вместо этой строки сюда писать запрос - ответ на задачу 5
select productName, sum(t1.quantityOrdered * t1.priceEach) as total
from orderdetails t1
join products t2
on t1.productcode=t2.productcode
group by 1
order by 2 desc
limit 10

Задача 6
#Вместо этой строки сюда писать запрос - ответ на задачу 6
select firstName, lastName, contactFirstName, contactLastName
from employees t1
left join customers t2
on t1.employeenumber=t2.salesrepemployeenumber
union
select firstName, lastName, contactFirstName, contactLastName
from employees t1
right join customers t2
on t1.employeenumber=t2.salesrepemployeenumber

Задача 7
#Вместо этой строки сюда писать запрос - ответ на задачу 7

select t1.firstName, t1.lastName, t1.jobtitle, 
t2.firstName subfirstname, t2.lastName sublastname
from employees t1
left join employees t2
on t1.employeenumber=t2.reportsto
